<div class="container" id="metrics">
  <div class="row">
    <div class="col">
      <ul data-pie-id="my-cool-chart">
        <li data-value="36">Pepperoni</li>
        <li data-value="14">Sausage</li>
        <li data-value="8">Cheese</li>
        <li data-value="11">Mushrooms</li>
        <li data-value="7">Chicken</li>
        <li data-value="24">Other</li>
      </ul>
      <div id="my-cool-chart"></div>
      <h2 class="metric">Income</h2>
    </div>
    <div class="col">
      <div class="pie-chart"></div>
      <h2 class="metric">Spending</h2>
    </div>
    <div class="col">
      <div class="pie-chart"></div>
      <h2 class="metric">Tithing</h2>
    </div>    
  </div>
</div>





<div class-="container" id="add-purchase">
  <form class="inline" action="/add_purchase" method="get">
    <input class="edit" type="submit" value="Add a Purchase">
  </form>
</div>

<div class="container" id="income">
  <div class="row">
    <div class="col">
      <h2>Monthly Income:</h2>
      $<strong><%= @income %></strong>
    </div>
    <div class="justify-content-end">
      <div class="col">
        <form class="inline" action="/budget/edit_income" method="get">
          <input class="inline" type="submit" value="Edit Income" />
        </form>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <table class="table">
    <thead>
      <tr>
        <th scope="col">Category</th>
        <th scope="col">Budgeted</th>
        <th scope="col">Spent</th>
        <th scope="col">Remaining</th>
        <th scope="col" colspan="2"></th>
      </tr>
    </thead>
    <tbody>
      <% @categories[1..-1].each do |category| %>
        <tr>
          <td><%= category[:name] %></td>
          <td><%= category[:amount] %></td>
          <td><%= total_spending_in_one_category(@purchases, category[:name]) %></td>
          <td>100.00</td>
          <td>
            <form class="inline" action="/budget/<%= category[:id] %>/edit" method="get">
              <input class="edit" type="submit" value="Edit">
            </form>
          </td>
          <td>
            <form class="inline delete" action="/budget/<%= category[:id] %>/delete" method="post">
              <input class="delete" type="submit" value="Delete">
            </form>
          </td>
        <tr>
      <% end %>
    </tbody>
  </table>
  <form action="/budget/add_category" method="get">
        <input value="Add Category" type="submit" />
      </form>
</div>


  <h2>Total spending this month:</h2>

    <ul>
      <li class="expense-category">
      $<strong><%= display_as_money(total_spending_in_all_categories(@purchases)) %></strong> / <%= @income %>
      </li>
    </ul>

    <!--  if over_total_budget? 
      <p class="warning">WARNING: You've already spent more money this month than you're bringing in!</p>
     end  -->

    <h2>Total spending this month by category:</h2>

    <ul>
      <% @categories.each do |category| %>
      <!-- REPLACE BELOW WITH <li class="RUBY get_category_class(category) RUBY"> -->
        <li class="expense-category">
          <%= category[:name] %>: $<strong><%= total_spending_in_one_category(@purchases, category[:name]) %></strong> / <%= display_as_money(category[:amount]) %>
        </li>
      <% end %>
    </ul>

<h2>All Recent Spending:</h2>

  <% if @purchases.empty? %>
    <p>You haven't added any purchases yet!</p>
  <% else %>

  <ul>
    <% @purchases.each do |purchase| %>
      <li class="purchase">
        $<strong><%= purchase[:amount] %></strong> in the <%= purchase[:category] %> category on <%= purchase[:date] %>
        <form class="inline" action="/budget/purchases/<%= purchase[:id] %>/edit" method="get">
           <button class= "edit" type="submit">Edit</button>
        </form>
        
          <form class="inline delete" action="/budget/purchases/<%= purchase[:id] %>/delete" method="post">
             <button class="delete" type="submit">Delete</button>
          </form>
        
      </li>
    <% end %>
  </ul>

    <% end %>

<% if @categories.size > 0 %>
  <form class="inline" action="/add_purchase" method="get">
    <button class="edit" type="submit">Add Purchase</button>
  </form>
  <% unless @purchases.empty? %>
    <form class="inline delete" action="/budget/purchases/delete_all" method="post">
      <button class="delete" type="submit">Reset All Purchases</button>
    </form>
  <% end %>
<% else %>
  <p>Please add some categories, and then you can submit purchases to track your budget!</p>
<% end %>

<% if session[:username] %>
  <p class="user-status">Signed in as <%= session[:username] %>
  <form action="/users/signout" method="post">
    <button class="edit" type="submit">Sign Out</button>
  </form>
<% else %>
  <form action="/users/signin" method="get">
    <button type="submit">Sign In</button>
  </form>
<% end %>