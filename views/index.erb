<header>
  <h1>** Easy Budget ** </h1>
  <h2 class="version">v1.0</h2>
</header>
  
    
<h2>Monthly Income:</h2>
<ul>
  <li class="expense-category">
  $<strong><%= @income %></strong>
    <form class="inline" action="/budget/edit_income" method="get">
      <button class="edit" type="submit">Edit Income</button>
    </form>
  </li>
</ul>
<h2>Monthly Expense Categories:</h2>

<% if @categories.size <= 1 %>
  <p>You haven't added any categories yet!</p>
<% else %>

  <ul>
    <% @categories[1..-1].each do |category| %>
      <li class="expense-category">
        <%= category[:name] %>: $<strong><%= category[:amount] %></strong>
        <% if category[:id] != "1" %>
          <form class="inline" action="/budget/<%= category[:id] %>/edit" method="get">
            <button class="edit" type="submit">Edit</button>
          </form>
          <form class="inline delete" action="/budget/<%= category[:id] %>/delete" method="post">
            <button class="delete" type="submit">Delete</button>
          </form>
        <% end %>
      </li>
    <% end %>
  </ul>


<% end %>

  <form action="/budget/add_category" method="get">
    <button class="edit" type="submit">Add Category</button>
  </form>

  <h2>Total Categorized Expenses:</h2>
    <ul>
      <li class="expense-category">
        $<strong><%= display_as_money(total_money_budgeted) %></strong> / <%= @income %>
      </li>
    </ul>
  
    <% if over_budget? %>
      <p class="warning">WARNING: Your expenses currently exceed your monthly income!</p>
    <% end %>

  

  <h2>Total spending this month:</h2>

    <ul>
      <li class="expense-category">
      $<strong><%= display_as_money(total_spending_in_all_categories(@purchases)) %></strong> / <%= @income %>
      </li>
    </ul>

    <!--  if over_total_budget? 
      <p class="warning">WARNING: You've already spent more money this month than you're bringing in!</p>
     end  -->

    <h2>Total spending this month by category:</h2>

    <ul>
      <% @categories.each do |category| %>
      <!-- REPLACE BELOW WITH <li class="RUBY get_category_class(category) RUBY"> -->
        <li class="expense-category">
          <%= category[:name] %>: $<strong><%= total_spending_in_one_category(@purchases, category[:name]) %></strong> / <%= display_as_money(category[:amount]) %>
        </li>
      <% end %>
    </ul>

<h2>All Recent Spending:</h2>

  <% if @purchases.empty? %>
    <p>You haven't added any purchases yet!</p>
  <% else %>

  <ul>
    <% @purchases.each do |purchase| %>
      <li class="purchase">
        $<strong><%= purchase[:amount] %></strong> in the <%= purchase[:category] %> category on <%= purchase[:date] %>
        <form class="inline" action="/budget/purchases/<%= purchase[:id] %>/edit" method="get">
           <button class= "edit" type="submit">Edit</button>
        </form>
        
          <form class="inline delete" action="/budget/purchases/<%= purchase[:id] %>/delete" method="post">
             <button class="delete" type="submit">Delete</button>
          </form>
        
      </li>
    <% end %>
  </ul>

    <% end %>

<% if @categories.size > 0 %>
  <form class="inline" action="/add_purchase" method="get">
    <button class="edit" type="submit">Add Purchase</button>
  </form>
  <% unless @purchases.empty? %>
    <form class="inline delete" action="/budget/purchases/delete_all" method="post">
      <button class="delete" type="submit">Reset All Purchases</button>
    </form>
  <% end %>
<% else %>
  <p>Please add some categories, and then you can submit purchases to track your budget!</p>
<% end %>

<% if session[:username] %>
  <p class="user-status">Signed in as <%= session[:username] %>
  <form action="/users/signout" method="post">
    <button class="edit" type="submit">Sign Out</button>
  </form>
<% else %>
  <form action="/users/signin" method="get">
    <button type="submit">Sign In</button>
  </form>
<% end %>